%{
#include <stdio.h>
#include <string.h>

int comments = 0, keywords = 0, identifiers = 0, words = 0, lines = 0, spaces = 0;

char *keyword_list[] = {
    "char", "double", "if", "else", "for", "while", "return",
    "void", "main", "int", "float", NULL
};

int is_keyword(char *word) {
    for (int i = 0; keyword_list[i] != NULL; i++) {
        if (strcmp(word, keyword_list[i]) == 0)
            return 1;
    }
    return 0;
}
%}

%%   <-- MUST BE EXACTLY HERE (after %})

\n              { lines++; }
[ \t]+          { spaces += yyleng; }

"//".*          { comments++; }
"/"([^]|\+[^/])"""*/"   { comments++; }

[a-zA-Z_][a-zA-Z0-9_]* {
                        words++;
                        if (is_keyword(yytext))
                            keywords++;
                        else
                            identifiers++;
                     }

.                ;

%%   <-- SECOND %% HERE

int main() {
    printf("Enter input (Ctrl+D to end):\n");
    yylex();

    printf("\nWords: %d\n", words);
    printf("Lines: %d\n", lines);
    printf("Spaces: %d\n", spaces);
    printf("Comments: %d\n", comments);
    printf("Keywords: %d\n", keywords);
    printf("Identifiers: %d\n", identifiers);
    return 0;
}

int yywrap() { return 1; }